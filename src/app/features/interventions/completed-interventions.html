<div class="mobile-wrapper" [class.dark-mode]="themeService.darkMode()">
  
  <header class="app-header">
    <div class="brand"><h1>Archives</h1></div>
    <div class="header-user">
      <span class="badge-count">{{ missions().length }}</span>
    </div>
  </header>

  <main class="container">
    <section class="recent-activity">
      <h3>Interventions encaissées</h3>

      @if (loading()) {
        <div class="loader">Accès aux archives...</div>
      } @else {
        <div class="intervention-list">
          @for (m of missions(); track m.$id) {
            <div class="intervention-card archive-card" (click)="viewInvoice(m.$id)">
              <div class="card-info">
                <span class="city">{{ m.habitants?.[0]?.nom || m.habitants?.nom || 'Client' }}</span>
                <span class="street">
                  {{ m.adresse?.ville }} — {{ m.completedAt | date:'dd/MM/yy' }}
                </span>
                <div class="archive-price">
                   Encaissé : {{ (m.travelCost || 0) + (m.totalFinal || 0) | number:'1.2-2' }}€
                </div>
              </div>
              
              <div class="card-status">
                <div class="check-circle">
                  <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="#2ecc71" stroke-width="3">
                    <polyline points="20 6 9 17 4 12"></polyline>
                  </svg>
                </div>
              </div>
            </div>
          } @empty {
            <div class="empty-state">Aucun historique de paiement.</div>
          }
        </div>
      }
    </section>
  </main>

  <nav class="bottom-nav">
    <a (click)="goBack()" class="nav-item">
       <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <line x1="8" y1="6" x2="21" y2="6"></line>
        <line x1="8" y1="12" x2="21" y2="12"></line>
        <line x1="8" y1="18" x2="21" y2="18"></line>
        <line x1="3" y1="6" x2="3.01" y2="6"></line>
        <line x1="3" y1="12" x2="3.01" y2="12"></line>
        <line x1="3" y1="18" x2="3.01" y2="18"></line>
      </svg>
      <span>Accueil</span>
    </a>
  </nav>
</div>