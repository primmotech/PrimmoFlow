<div class="mobile-wrapper" [class.dark-mode]="themeService.darkMode()">
  <header class="app-header-large">
    <div class="header-content">
      <h1>Whitelist</h1>
      <p>Gestion des accès autorisés</p>
    </div>
  </header>

  <main class="container">
    <section class="settings-group">
      <h3>Autoriser un accès</h3>
      <div class="settings-card">
        <div class="add-user-form">
          <input #emailInput type="email" placeholder="Email (ex: martin@mail.com)">
          <div class="row">
            <input #nameInput type="text" placeholder="Pseudo (ex: Mich)">
            <button (click)="addEmail(emailInput, nameInput)" class="add-full-btn">
              Ajouter
            </button>
          </div>
        </div>
      </div>
    </section>

    <section class="settings-group">
      <h3>Accès configurés</h3>
      <div class="settings-card">
        @if (loading()) {
          <div class="loader-inner">Chargement...</div>
        } @else {
          @for (user of authorizedUsers(); track user.email) {
            <div class="setting-item">
              <div class="setting-info" (click)="editNickName(user)">
                <div class="user-details">
                  <span class="user-nickname">
                    {{ user.nickName || 'Sans pseudo' }}
                    <svg class="edit-icon-mini" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
                    </svg>
                  </span>
                  <span class="user-email-sub">{{ user.email }}</span>
                </div>
              </div>

              <div class="select-wrapper">
                <select class="custom-select-small" 
                        [ngModel]="user.role" 
                        (change)="updateUserRole(user.email, $any($event.target).value)">
                  @for (role of roles(); track role.id) {
                    <option [value]="role.id">{{ role.id }}</option>
                  }
                </select>
              </div>

              <button (click)="deleteEmail(user.email)" class="delete-btn-rounded">
                <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2.5">
                  <polyline points="3 6 5 6 21 6"></polyline>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
              </button>
            </div>
          } @empty {
            <div class="empty-list-msg">Aucun utilisateur dans la liste.</div>
          }
        }
      </div>
    </section>
  </main>

 <nav class="bottom-nav">
   <a routerLink="/dashboard" class="nav-item">
       <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
        <line x1="8" y1="6" x2="21" y2="6"></line>
        <line x1="8" y1="12" x2="21" y2="12"></line>
        <line x1="8" y1="18" x2="21" y2="18"></line>
        <line x1="3" y1="6" x2="3.01" y2="6"></line>
        <line x1="3" y1="12" x2="3.01" y2="12"></line>
        <line x1="3" y1="18" x2="3.01" y2="18"></line>
      </svg>
      <span>Accueil</span>
    </a>
        <a routerLink="/parameters" class="nav-item">
  <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
  <path d="M18 6v8H6" />
  <path d="M10 10l-4 4 4 4" />
</svg>
      <span>Retour</span>
    </a>
 

  </nav>
</div>